(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{191:function(e,t,a){"use strict";a.r(t);var l={data:function(){return{activeNames:[],loading:!1,searchCollapse:!1,queryConfig:this.searchQuery}},methods:{reset:function(){window.location.href=this.tabledata.path},search:function(){var e=this.unils.setQueryConfig(this.queryConfig);e&&(window.location.href=this.tabledata.path+"?"+e)},handleChange:function(e,t){var a=this;t.properties instanceof Object&&(this.loading=!0,axios.post("/admin/logs/get_model_name_by_id",{id:t.id}).then((function(t){0!==t.data.code||200!==t.status?(a.$notify({title:"详情已被删除",message:t.data.message,type:"error"}),a.tabledata.data[e].properties=""):a.tabledata.data[e].properties="名称："+t.data.data.name,a.loading=!1})))},handleDelete:function(e,t){var a=this;this.loading=!0,axios.post("/admin/logs/delete/"+t).then((function(t){0!=t.data.code||200!=t.status?a.$notify({title:"Failed",message:t.data.message,type:"error"}):(a.$notify({title:"Success",message:"",type:"success"}),a.tabledata.data.splice(e,1)),a.loading=!1}))},filterTag:function(e,t){return t.real_name===e}},props:["tabledata","searchQuery","modelOptions","actionOptions"]},o=a(0),n=Object(o.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{attrs:{shadow:"hover"}},[a("el-form",{class:e.searchCollapse?"":"search-form-inline",attrs:{inline:!0,size:"mini"}},[a("el-form-item",{attrs:{label:"操作人:"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.queryConfig.causer_id,callback:function(t){e.$set(e.queryConfig,"causer_id",t)},expression:"queryConfig.causer_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"模块:"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.queryConfig.model,callback:function(t){e.$set(e.queryConfig,"model",t)},expression:"queryConfig.model"}},e._l(e.modelOptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"动作:"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.queryConfig.action,callback:function(t){e.$set(e.queryConfig,"action",t)},expression:"queryConfig.action"}},e._l(e.actionOptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label}})})),1)],1),e._v(" "),e.searchCollapse?a("el-form-item",{attrs:{label:"日期:"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.queryConfig.date,callback:function(t){e.$set(e.queryConfig,"date",t)},expression:"queryConfig.date"}})],1):e._e(),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"info"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1),e._v(" "),a("button",{staticClass:"el-button el-button--text el-button--small",staticStyle:{"margin-left":"8px"},attrs:{type:"button"},on:{click:function(t){e.searchCollapse=!e.searchCollapse}}},[e.searchCollapse?a("span",[e._v(" 收起 "),a("i",{staticClass:"el-icon-arrow-up"})]):a("span",[e._v(" 展开 "),a("i",{staticClass:"el-icon-arrow-down"})])])],1)],1),e._v(" "),a("el-card",{staticClass:"margin_top",attrs:{shadow:"hover"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tabledata.data,size:"small"}},[a("el-table-column",{attrs:{prop:"id",label:"序号",width:"70px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"日期"}}),e._v(" "),a("el-table-column",{attrs:{prop:"log_name",label:"模块"}}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"动作"}}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"内容"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{directives:[{name:"show",rawName:"v-show",value:t.row.subject_type,expression:"scope.row.subject_type"}]},[t.row.properties instanceof Object?a("button",{staticClass:"el-button el-button--text el-button--small",on:{click:function(a){return e.handleChange(t.$index,t.row)}}},[a("span",[e._v(" 查看详情 "),a("i",{staticClass:"el-icon-arrow-down"})])]):a("div",[e._v(e._s(t.row.properties))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作人",prop:"real_name"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popconfirm",{attrs:{title:"此条记录确定永久删除吗？"},on:{confirm:function(a){return e.handleDelete(t.$index,t.row.id)}}},[a("el-button",{attrs:{slot:"reference",size:"small",type:"text"},slot:"reference"},[e._v("删除")])],1)]}}])})],1)],1)],1)}),[],!1,null,null,null);t.default=n.exports}}]);